axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = c(0.75,0.5))
ggsave(file = "~/Chinook_growth_repo/figures/random_forest_k4.png",
p,
width = 10,
height = 12)
stock_characteristics$stock_char <- stock_characteristics$stock
d_merged_k2 <- merge(data_clusters_k2 ,stock_characteristics, by = "stock_char")
p <- ggplot(d_merged_k2 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI)),
aes(x = as.factor(cluster),
y = ODI, fill = as.factor(cluster)))+
geom_boxplot()+
scale_fill_manual(values = pnw_palette("Cascades", n=2),
name = "Cluster")+
xlab("Cluster")+
ylab("Ocean Distribution Index (ODI)")+
theme_classic()+
theme(strip.text = element_text(size=20, family = "Times New Roman"),
axis.title = element_text(size=28, family = "Times New Roman"),
axis.text = element_text(size=24, family = "Times New Roman"),
legend.title = element_text(size=28, family = "Times New Roman"),
legend.text  = element_text(size=24, family = "Times New Roman"),
legend.position = "none")
ggsave(file = "figures/Clusters_ODI_n2_seed2.png",
p,
width = 5,
height = 4)
ggsave(file = "figures/Clusters_ODI_n2_seed2.png",
p,
width = 7,
height = 5.5)
ggsave(file = "figures/Clusters_ODI_n2_seed2.png",
p,
width = 7,
height = 6.0)
#####  random forest plot ######
var_imp_k2 <- read.csv(
"~/Chinook_growth_repo/model_output/clusters/RF_importnace_values_n2.csv")
var_imp_k2$variable <- reorder(var_imp_k2$variable,var_imp_k2$MeanDecreaseGini)
var_imp_k2$variable
p <- ggplot(var_imp_k2,
aes(x = MeanDecreaseGini,
y =variable,
fill = var_type))+
geom_bar(stat = "identity")+
scale_fill_manual(values = pnw_palette("Bay", n=4),
name = "Variable")+
theme_classic()+
xlab("Mean Decreasing Gini")+
ylab("Variable")+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = c(0.75,0.5))
ggsave(file = "~/Chinook_growth_repo/figures/random_forest_k2.png",
p,
width = 9,
height = 12)
# ocean distribution
stock_characteristics$stock_char <- stock_characteristics$stock
d_merged_k2 <- merge(data_clusters_k2 ,stock_characteristics, by = "stock_char")
p <- ggplot(d_merged_k2 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI)),
aes(x = as.factor(cluster),
y = ODI, fill = as.factor(cluster)))+
geom_boxplot()+
scale_fill_manual(values = pnw_palette("Cascades", n=2),
name = "Cluster")+
xlab("Cluster")+
ylab("Ocean Distribution Index (ODI)")+
theme_classic()+
theme(strip.text = element_text(size=20, family = "Times New Roman"),
axis.title = element_text(size=28, family = "Times New Roman"),
axis.text = element_text(size=24, family = "Times New Roman"),
legend.title = element_text(size=28, family = "Times New Roman"),
legend.text  = element_text(size=24, family = "Times New Roman"),
legend.position = "none")
ggsave(file = "figures/Clusters_ODI_n2_seed2.png",
p,
width = 7,
height = 6.0)
# p vlaue
d_test <- d_merged_k2 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI))
print(paste("N = ",nrow(d_test)))
kruskal.test(as.factor(cluster) ~ ODI,
data = d_test )
p <- ggplot(d_merged_k2  %>%
group_by(stock_char)%>%
summarize(run = mean(run),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(run)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, run)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(run), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(run), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=2), name = "Cluster")+
# scale_fill_brewer(palette = "Dark2",
#                   name = "Cluster assignment")+
scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
p
ggsave(file = "figures/Clusters_run_type_n2_seed2.png",
p,
width = 7,
height = 6)
d_test <- d_merged  %>%
group_by(stock_char)%>%
summarize(run = mean(run.x),
cluster = mean(cluster))
print(paste("N = ",nrow(d_test)))
chisq.test(d_chisq$run,d_chisq$cluster, simulate.p.value=T)
p <- ggplot(d_merged_k2  %>%
group_by(stock_char)%>%
summarize(release_age = mean(release_age),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(release_age)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, release_age)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(release_age), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(release_age), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=2), name = "Cluster")+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
p
ggsave(file = "figures/Clusters_release_age_n2_seed2.png",
p,
width = 7,
height = 6)
p <- ggplot(d_merged_k2  %>%
group_by(stock_char)%>%
summarize(run = mean(run.x),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(run)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, run)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(run), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(run), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=2), name = "Cluster")+
# scale_fill_brewer(palette = "Dark2",
#                   name = "Cluster assignment")+
scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
p
ggsave(file = "figures/Clusters_run_type_n2_seed2.png",
p,
width = 7,
height = 6)
# ocean distribution
stock_characteristics$stock_char <- stock_characteristics$stock
d_merged_k3 <- merge(data_clusters_k3,stock_characteristics, by = "stock_char")
p <- ggplot(d_merged_k3 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI)),
aes(x = as.factor(cluster),
y = ODI, fill = as.factor(cluster)))+
geom_boxplot()+
scale_fill_manual(values = pnw_palette("Cascades", n=3),
name = "Cluster")+
xlab("Cluster")+
ylab("Ocean Distribution Index (ODI)")+
theme_classic()+
theme(strip.text = element_text(size=20, family = "Times New Roman"),
axis.title = element_text(size=28, family = "Times New Roman"),
axis.text = element_text(size=24, family = "Times New Roman"),
legend.title = element_text(size=28, family = "Times New Roman"),
legend.text  = element_text(size=24, family = "Times New Roman"),
legend.position = "none")
ggsave(file = "figures/Clusters_ODI_n3_seed2.png",
p,
width = 7,
height = 6)
d_test <- d_merged_k3 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI))
print(paste("N = ",nrow(d_test)))
kruskal.test(as.factor(cluster) ~ ODI,
data = d_test )
p <- ggplot(d_merged_k3  %>%
group_by(stock_char)%>%
summarize(run = mean(run),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(run)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, run)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(run), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(run), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=3), name = "Cluster")+
scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_run_type_n3_seed2.png",
p,
width = 7,
height = 6)
d_test <- d_merged_k3  %>%
group_by(stock_char)%>%
summarize(run = mean(run),
cluster = mean(cluster))
print(paste("N = ",nrow(d_test)))
chisq.test(d_test$run,d_test$cluster, simulate.p.value=T)
p <- ggplot(d_merged_k3  %>%
group_by(stock_char)%>%
summarize(release_age = mean(release_age),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(release_age)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, release_age)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(release_age), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(release_age), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=3), name = "Cluster")+
#scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_release_age_n3_seed2.png",
p,
width = 7,
height = 6)
p <- ggplot(d_merged_k3  %>%
group_by(stock_char)%>%
summarize(run = mean(run.x),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(run)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, run)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(run), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(run), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=3), name = "Cluster")+
scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_run_type_n3_seed2.png",
p,
width = 7,
height = 6)
#####  random forest plot ######
var_imp_k3 <- read.csv(
"~/Chinook_growth_repo/model_output/clusters/RF_importnace_values_n3.csv")
var_imp_k3$variable <- reorder(var_imp_k3$variable,var_imp_k3$MeanDecreaseGini)
p <- ggplot(var_imp_k3,
aes(x = MeanDecreaseGini,
y =variable,
fill = var_type))+
geom_bar(stat = "identity")+
scale_fill_manual(values = pnw_palette("Bay", n=4),
name = "Variable")+
theme_classic()+
xlab("Mean Decreasing Gini")+
ylab("Variable")+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = c(0.75,0.5))
ggsave(file = "~/Chinook_growth_repo/figures/random_forest_k3.png",
p,
width = 9,
height = 12)
# using seed 2
stock_characteristics <- read.csv("transformed_data/stock_characteristics_data.csv")
data_clusters_k4 <- read.csv("~/Chinook_growth_repo/model_output/clusters/data_n4_age4_seed2.csv")
# plot cluster trends
p <- ggplot(data_clusters_k4 %>%
filter(age == 4) %>%
group_by(brood_year, stock, cluster)%>%
summarize(length = mean(length)),
aes(x = brood_year+4, y = length, color = as.factor(cluster), group = as.factor(stock)))+
geom_point(size = 0.75, alpha = 0.5)+
geom_line(size = 0.1)+
geom_hline(aes(yintercept = -2),linetype = 2,size = 0.5)+
geom_hline(aes(yintercept = 2),linetype = 2,size = 0.5)+
facet_wrap(~cluster,
ncol = 1,
labeller = labeller(cluster =
c("1" = "Cluster: 1",
"2" = "Cluster: 2",
"3" = "Cluster: 3",
"4" = "Cluster: 4")))+
geom_smooth( aes(group = as.factor(cluster)),alpha = 0.2)+
theme_test()+
ylim(-2.5,2.5)+
ylab("Scaled lengths")+
xlab("Year")+
scale_color_manual(values = pnw_palette("Cascades", n=4), name = "Cluster")+
theme(strip.text = element_text(size=20, family = "Times New Roman"),
axis.title = element_text(size=28, family = "Times New Roman"),
axis.text = element_text(size=24, family = "Times New Roman"),
legend.title = element_text(size=28, family = "Times New Roman"),
legend.text  = element_text(size=24, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_trends_n4_seed2.png",
p,
width = 6,
height = 10)
# ocean distribution
stock_characteristics$stock_char <- stock_characteristics$stock
d_merged_k4 <- merge(data_clusters_k4,stock_characteristics, by = "stock_char")
p<-ggplot(d_merged_k4 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI)),
aes(x = as.factor(cluster),
y = ODI, fill = as.factor(cluster)))+
geom_boxplot()+
scale_fill_manual(values = pnw_palette("Cascades", n=4),
name = "Cluster")+
xlab("Cluster")+
ylab("Ocean Distribution Index (ODI)")+
theme_classic()+
theme(strip.text = element_text(size=20, family = "Times New Roman"),
axis.title = element_text(size=28, family = "Times New Roman"),
axis.text = element_text(size=24, family = "Times New Roman"),
legend.title = element_text(size=28, family = "Times New Roman"),
legend.text  = element_text(size=24, family = "Times New Roman"),
legend.position = "none")
ggsave(file = "figures/Clusters_ODI_n4_seed2.png",
p,
width = 7,
height = 6)
d_test <- d_merged_k4 %>%
group_by(stock_char)%>%
summarize(cluster = mean(cluster),
ODI= mean(ODI))
print(paste("N = ",nrow(d_test)))
kruskal.test(as.factor(cluster) ~ ODI,
data = d_test )
p<-ggplot(d_merged_k4  %>%
group_by(stock_char)%>%
summarize(run = mean(run),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(run)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, run)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(run), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(run), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=4), name = "Cluster")+
scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_run_type_n4_seed2.png",
p,
width = 7,
height = 6)
p <- ggplot(d_merged_k4  %>%
group_by(stock_char)%>%
summarize(release_age = mean(release_age),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(release_age)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, release_age)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(release_age), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(release_age), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=4), name = "Cluster")+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_release_age_n4_seed2.png",
p,
width = 7,
height = 6)
#####  random forest plot ######
var_imp_k4 <- read.csv(
"~/Chinook_growth_repo/model_output/clusters/RF_importnace_values_n4.csv")
var_imp_k4$variable <- reorder(var_imp_k4$variable,var_imp_k4$MeanDecreaseGini)
p <- ggplot(var_imp_k4,
aes(x = MeanDecreaseGini,
y =variable,
fill = var_type))+
geom_bar(stat = "identity")+
scale_fill_manual(values = pnw_palette("Bay", n=4),
name = "Variable")+
theme_classic()+
xlab("Mean Decreasing Gini")+
ylab("Variable")+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = c(0.75,0.5))
ggsave(file = "~/Chinook_growth_repo/figures/random_forest_k4.png",
p,
width = 9,
height = 12)
p<-ggplot(d_merged_k4  %>%
group_by(stock_char)%>%
summarize(run = mean(run.x),
cluster = mean(cluster))%>%
ungroup()%>%
dplyr::group_by(run)%>%
dplyr::mutate(m = n())%>%
dplyr::ungroup()%>%
dplyr::group_by(cluster, run)%>%
dplyr::summarise(p = n()/mean(m),
m = mean(m)),
aes(x = as.factor(run), y = p, fill = as.factor(cluster)))+
geom_bar(stat = "identity")+
geom_text(aes(x = as.factor(run), y = 1.025, label = paste("n =", m)))+
scale_fill_manual(values = pnw_palette("Cascades", n=4), name = "Cluster")+
scale_x_discrete(label = c("Spring", "Summer", "Fall", "Late Fall"))+
ylab("Proporiton")+
xlab("Run timing")+
theme_test()+
theme(axis.title = element_text(size = 28, family = "Times New Roman"),
axis.text = element_text(size = 24, family = "Times New Roman"),
legend.text = element_text(size = 24, family = "Times New Roman"),
legend.title = element_text(size = 22, family = "Times New Roman"),
legend.position = "bottom")
ggsave(file = "figures/Clusters_run_type_n4_seed2.png",
p,
width = 7,
height = 6)
